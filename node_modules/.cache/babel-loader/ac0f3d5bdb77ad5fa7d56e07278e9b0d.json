{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\Md. Mehrab Haque\\\\Desktop\\\\satellight\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,createRef,useRef,useEffect,useLayoutEffect,forwardRef,useImperativeHandle}from'react';import{getSatelliteInfo}from\"tle.js\";import Globe,{Point}from'react-globe.gl';import*as THREE from'three';import{sat_data}from'../assets/master';var map=function map(value,x1,y1,x2,y2){return(value-x1)*(y2-x2)/(y1-x1)+x2;};var sat_arr=[];Object.keys(sat_data).map(function(key,ind){var data=sat_data[key];console.log(key);sat_arr.push(getSatelliteInfo([data.tle_line1,data.tle_line2],Date.now(),0,0,0));});var point_arr=[],interval,currCode;sat_arr.map(function(sat,ind){var schema={lat:sat.lat,lng:sat.lng,alt:sat.height/6400,radius:map(sat.height,400,35000,3,12),height:sat.height,velocity:sat.velocity,color:'#000000',ind:ind};point_arr.push(schema);});var ModelView=forwardRef(function(props,ref){var _useState=useState(point_arr),_useState2=_slicedToArray(_useState,2),pointArr=_useState2[0],setPointArr=_useState2[1];var _useState3=useState({height:0,width:0}),_useState4=_slicedToArray(_useState3,2),container=_useState4[0],setContainer=_useState4[1];var _useState5=useState(props.satCode),_useState6=_slicedToArray(_useState5,2),satCode=_useState6[0],setSatCode=_useState6[1];var globeEl=useRef();currCode=props.satCode;useImperativeHandle(ref,function(){return{setSatellite:function setSatellite(sat){setSatCode(sat.satCode);}};});useEffect(function(){//globeEl.current.controls().autoRotate = true;\n//globeEl.current.controls().autoRotateSpeed = 0.2;\nconsole.log(props.parent.current.offsetWidth);setContainer({height:props.parent.current.offsetHeight,width:props.parent.current.offsetWidth});},[]);useEffect(function(){var defaultSat=Object.keys(sat_data).indexOf(satCode);globeEl.current.pointOfView({lat:point_arr[defaultSat].lat,lng:point_arr[defaultSat].lng,altitude:pointArr[defaultSat].alt+1.2},1000);},[satCode]);useEffect(function(){if(satCode){interval=setInterval(function(){sat_arr=[];Object.keys(sat_data).map(function(key,ind){var data=sat_data[key];sat_arr.push(getSatelliteInfo([data.tle_line1,data.tle_line2],Date.now(),23.762397,90.418917,0));});//console.log(satCode)\npoint_arr=[];sat_arr.map(function(sat,ind){var schema={lat:sat.lat,lng:sat.lng,alt:sat.height/6400,radius:map(sat.height,400,35000,2.5,6),height:sat.height,velocity:sat.velocity,color:'#000000',ind:ind};if(Object.keys(sat_data)[ind]==currCode){schema['color']='#ff0000';//console.log(Object.keys(sat_data)[ind]+' '+satCode)\n}point_arr.push(schema);});setPointArr(point_arr);},500);}else{clearInterval(interval);}},[satCode]);return/*#__PURE__*/React.createElement(Globe,{showAtmosphere:false,backgroundColor:\"#ffffff\",height:container.height,width:container.width,ref:globeEl,globeImageUrl:\"//unpkg.com/three-globe/example/img/earth-day.jpg\",bumpImageUrl:\"//unpkg.com/three-globe/example/img/earth-topology.png\",showGraticules:true,onCustomLayerHover:function onCustomLayerHover(d){if(d!=null&&d!=undefined){}},onCustomLayerClick:function onCustomLayerClick(d){if(d!=null&&d!=undefined){}},customLayerData:pointArr,customThreeObject:function customThreeObject(d){var mesh=new THREE.Mesh(new THREE.SphereBufferGeometry(d.radius),new THREE.MeshLambertMaterial({color:d.color}));var group=new THREE.Group();group.add(mesh);return group;},customThreeObjectUpdate:function customThreeObjectUpdate(obj,d){Object.assign(obj.position,globeEl.current.getCoords(d.lat,d.lng,d.alt));}});});export default ModelView;","map":{"version":3,"sources":["C:/Users/Md. Mehrab Haque/Desktop/satellight/src/components/ModelView.js"],"names":["React","useState","createRef","useRef","useEffect","useLayoutEffect","forwardRef","useImperativeHandle","getSatelliteInfo","Globe","Point","THREE","sat_data","map","value","x1","y1","x2","y2","sat_arr","Object","keys","key","ind","data","console","log","push","tle_line1","tle_line2","Date","now","point_arr","interval","currCode","sat","schema","lat","lng","alt","height","radius","velocity","color","ModelView","props","ref","pointArr","setPointArr","width","container","setContainer","satCode","setSatCode","globeEl","setSatellite","parent","current","offsetWidth","offsetHeight","defaultSat","indexOf","pointOfView","altitude","setInterval","clearInterval","d","undefined","mesh","Mesh","SphereBufferGeometry","MeshLambertMaterial","group","Group","add","obj","assign","position","getCoords"],"mappings":"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","sourcesContent":["import React,{useState,createRef,useRef,useEffect,useLayoutEffect,forwardRef, useImperativeHandle} from 'react'\r\nimport { getSatelliteInfo } from \"tle.js\";\r\nimport Globe,{Point} from 'react-globe.gl';\r\nimport * as THREE from 'three'\r\nimport {sat_data} from '../assets/master'\r\n\r\nconst map = (value, x1, y1, x2, y2) => (value - x1) * (y2 - x2) / (y1 - x1) + x2;\r\n\r\nvar sat_arr=[]\r\nObject.keys(sat_data).map((key,ind)=>{\r\n  var data=sat_data[key]\r\n  console.log(key)\r\n  sat_arr.push(getSatelliteInfo([data.tle_line1,data.tle_line2],Date.now(),0,0,0))\r\n})\r\n\r\n  var point_arr=[],interval,currCode\r\n  sat_arr.map((sat,ind)=>{\r\n    var schema={\r\n      lat:sat.lat,\r\n      lng:sat.lng,\r\n      alt:sat.height/6400,\r\n      radius:map(sat.height,400,35000,3,12),\r\n      height:sat.height,\r\n      velocity:sat.velocity,\r\n      color:'#000000',\r\n      ind:ind\r\n    }\r\n    point_arr.push(schema)\r\n  })\r\n\r\nconst ModelView=forwardRef((props,ref)=>{\r\n\r\n  const [pointArr, setPointArr] = useState(point_arr);\r\n  const [container,setContainer]=useState({height:0,width:0})\r\n  const [satCode,setSatCode]=useState(props.satCode)\r\n  const globeEl = useRef();\r\n  currCode=props.satCode\r\n\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    setSatellite(sat){\r\n      setSatCode(sat.satCode)\r\n    }\r\n }));\r\n\r\n\r\n\r\n  useEffect(()=>{\r\n    //globeEl.current.controls().autoRotate = true;\r\n      //globeEl.current.controls().autoRotateSpeed = 0.2;\r\n      console.log(props.parent.current.offsetWidth)\r\n      setContainer({\r\n        height:props.parent.current.offsetHeight,\r\n        width:props.parent.current.offsetWidth\r\n      })\r\n  },[])\r\n\r\n  useEffect(()=>{\r\n    var defaultSat=Object.keys(sat_data).indexOf(satCode)\r\n    globeEl.current.pointOfView({ lat:point_arr[defaultSat].lat,lng:point_arr[defaultSat].lng,altitude:pointArr[defaultSat].alt+1.2 },1000);\r\n  },[satCode])\r\n\r\n  useEffect(()=>{\r\n    if(satCode) {\r\n      interval = setInterval(() => {\r\n        sat_arr=[]\r\n        Object.keys(sat_data).map((key,ind)=>{\r\n          var data=sat_data[key]\r\n          sat_arr.push(getSatelliteInfo([data.tle_line1,data.tle_line2],Date.now(),23.762397,90.418917,0))\r\n        })\r\n        //console.log(satCode)\r\n        point_arr=[]\r\n        sat_arr.map((sat,ind)=>{\r\n          var schema={\r\n            lat:sat.lat,\r\n            lng:sat.lng,\r\n            alt:sat.height/6400,\r\n            radius:map(sat.height,400,35000,2.5,6),\r\n            height:sat.height,\r\n            velocity:sat.velocity,\r\n            color:'#000000',\r\n            ind:ind\r\n          }\r\n          if(Object.keys(sat_data)[ind]==currCode){\r\n            schema['color']='#ff0000'\r\n            //console.log(Object.keys(sat_data)[ind]+' '+satCode)\r\n          }\r\n          point_arr.push(schema)\r\n        })\r\n        setPointArr(point_arr)\r\n      }, 500);\r\n    } else {\r\n      clearInterval(interval);\r\n    }\r\n  },[satCode])\r\n\r\n  return(\r\n\r\n      <Globe\r\n\r\n            showAtmosphere={false}\r\n            backgroundColor='#ffffff'\r\n            height={container.height}\r\n            width={container.width}\r\n            ref={globeEl}\r\n            globeImageUrl=\"//unpkg.com/three-globe/example/img/earth-day.jpg\"\r\n            bumpImageUrl=\"//unpkg.com/three-globe/example/img/earth-topology.png\"\r\n\r\n            showGraticules={true}\r\n\r\n\r\n            onCustomLayerHover={d=>{\r\n                if(d!=null && d!=undefined){\r\n\r\n                }\r\n              }\r\n          }\r\n\r\n          onCustomLayerClick={d=>{\r\n              if(d!=null && d!=undefined){\r\n\r\n              }\r\n            }\r\n        }\r\n\r\n        customLayerData={pointArr}\r\n        customThreeObject={d =>{\r\n          var mesh=new THREE.Mesh(\r\n            new THREE.SphereBufferGeometry(d.radius),\r\n            new THREE.MeshLambertMaterial({ color: d.color })\r\n          )\r\n          var group=new THREE.Group()\r\n          group.add(mesh)\r\n          return group\r\n        }\r\n      }\r\n        customThreeObjectUpdate={(obj, d) => {\r\n          Object.assign(obj.position, globeEl.current.getCoords(d.lat, d.lng, d.alt));\r\n        }}\r\n       />\r\n\r\n  )\r\n})\r\n\r\nexport default ModelView\r\n"]},"metadata":{},"sourceType":"module"}