{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\Md. Mehrab Haque\\\\Desktop\\\\satellight\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,createRef,useRef,useEffect,forwardRef,useImperativeHandle}from'react';import{getSatelliteInfo}from\"tle.js\";var posInterval,timeDiff,pathInterval,map,marker,mymarker,infoWindow,myinfoWindow,polyLine,poly=[],tle,data;function getNormalizedCoord(coord,zoom){var y=coord.y;var x=coord.x;var tileRange=1<<zoom;if(y<0||y>=tileRange){return null;}if(x<0||x>=tileRange){x=(x%tileRange+tileRange)%tileRange;}return{x:x,y:y};}var MapView=forwardRef(function(props,ref){tle=[props.data.tle_line1,props.data.tle_line2];data=props.data;timeDiff=props.timeDiff;var _useState=useState(props.satCode),_useState2=_slicedToArray(_useState,2),satCode=_useState2[0],setSatCode=_useState2[1];var initialData=getSatelliteInfo(tle,Date.now()+timeDiff,0,0);var containerRef=useRef();useEffect(function(){poly=[];map=new window.google.maps.Map(containerRef.current,{center:{lat:initialData.lat,lng:initialData.lng},zoom:3,streetViewControl:false,mapTypeControlOptions:{mapTypeIds:[window.google.maps.MapTypeId.ROADMAP,window.google.maps.MapTypeId.HYBRID,'Sky']}});var skyMapType=new window.google.maps.ImageMapType({getTileUrl:function getTileUrl(coord,zoom){var normalizedCoord=getNormalizedCoord(coord,zoom);if(!normalizedCoord){return\"\";}var bound=Math.pow(2,zoom);return\"https://mw1.google.com/mw-planetary/sky/skytiles_v1\"+\"/\"+normalizedCoord.x+\"_\"+(bound-normalizedCoord.y-1)+\"_\"+zoom+\".jpg\";},tileSize:new window.google.maps.Size(256,256),maxZoom:9,minZoom:0,radius:1738000,name:\"Sky\"});map.mapTypes.set(\"Sky\",skyMapType);var iconMarker=new window.google.maps.MarkerImage(data.icon_url,null,new window.google.maps.Point(0,0),/* origin is 0,0 */new window.google.maps.Point(30,30),/* anchor is bottom center of the scaled image */new window.google.maps.Size(60,50));marker=new window.google.maps.Marker({position:map.center,icon:iconMarker,title:\"Hello World!\"});mymarker=new window.google.maps.Marker({position:map.center});mymarker.setVisible(false);marker.addListener(\"click\",function(){props.fpv();});infoWindow=new window.google.maps.InfoWindow({content:'<div>Hello World !!!</div>'});myinfoWindow=new window.google.maps.InfoWindow({content:'<div>Your Location</div>'});infoWindow.open(map,marker);polyLine=new window.google.maps.Polyline({path:poly,geodesic:true,strokeColor:\"#FF0000\",strokeOpacity:1.0,strokeWeight:4});polyLine.setMap(map);console.log(props.location);if(props.location!=null)markPosition(props.location);mymarker.setMap(map);marker.setMap(map);map.panTo(marker.getPosition());},[]);var markPosition=function markPosition(location){mymarker.setPosition({lat:location.lat,lng:location.lng});mymarker.setVisible(true);myinfoWindow.open(map,mymarker);mymarker.setMap(map);marker.setMap(map);map.panTo(marker.getPosition());};useEffect(function(){if(satCode){posInterval=setInterval(function(){var currData=getSatelliteInfo(tle,Date.now()+timeDiff,0,0);marker.setPosition({lat:currData.lat,lng:currData.lng});var info=\"<div>\\n            <center><span>\".concat(data.sat_name,\"</span></center>\\n            <center><img   height=\\\"30px\\\" width='40px' src='\").concat(data.country_flag,\"'/></center>\")+'<center>Lat:'+currData.lat.toFixed(3)+', Lng:'+currData.lng.toFixed(3)+'</center>'+'<center>Velocity:'+currData.velocity.toFixed(3)+'km/s <br/> Height:'+currData.height.toFixed(3)+'km</center>'+'<center>'+new Date(Date.now()+timeDiff).toLocaleString()+'</center>'+'</div>';infoWindow.setContent(info);},100);pathInterval=setInterval(function(){var currData=getSatelliteInfo(tle,Date.now()+timeDiff,0,0);poly.push(currData);polyLine.setPath(poly);},1000);}else{clearInterval(posInterval);clearInterval(pathInterval);}},[satCode]);useImperativeHandle(ref,function(){return{setSatellite:function setSatellite(sat){data=sat.data;tle=[sat.data.tle_line1,sat.data.tle_line2];poly=[];var currData=getSatelliteInfo(tle,Date.now()+timeDiff,0,0);var iconMarker=new window.google.maps.MarkerImage(data.icon_url,null,new window.google.maps.Point(0,0),/* origin is 0,0 */new window.google.maps.Point(30,30),/* anchor is bottom center of the scaled image */new window.google.maps.Size(60,50));marker.setIcon(iconMarker);map.panTo({lat:currData.lat,lng:currData.lng});setSatCode(sat.satCode);},setTimeDiff:function setTimeDiff(val){poly=[];var currData=getSatelliteInfo(tle,Date.now()+val,0,0);var iconMarker=new window.google.maps.MarkerImage(data.icon_url,null,new window.google.maps.Point(0,0),/* origin is 0,0 */new window.google.maps.Point(30,30),/* anchor is bottom center of the scaled image */new window.google.maps.Size(60,50));marker.setIcon(iconMarker);map.panTo({lat:currData.lat,lng:currData.lng});timeDiff=val;},location:function location(_location){markPosition(_location);map.panTo(marker.getPosition());//console.log(lat,lng)\n}};});return/*#__PURE__*/React.createElement(\"div\",{style:{width:\"100%\",height:\"100%\"},ref:containerRef});});export default MapView;","map":{"version":3,"sources":["C:/Users/Md. Mehrab Haque/Desktop/satellight/src/components/MapView.js"],"names":["React","useState","createRef","useRef","useEffect","forwardRef","useImperativeHandle","getSatelliteInfo","posInterval","timeDiff","pathInterval","map","marker","mymarker","infoWindow","myinfoWindow","polyLine","poly","tle","data","getNormalizedCoord","coord","zoom","y","x","tileRange","MapView","props","ref","tle_line1","tle_line2","satCode","setSatCode","initialData","Date","now","containerRef","window","google","maps","Map","current","center","lat","lng","streetViewControl","mapTypeControlOptions","mapTypeIds","MapTypeId","ROADMAP","HYBRID","skyMapType","ImageMapType","getTileUrl","normalizedCoord","bound","Math","pow","tileSize","Size","maxZoom","minZoom","radius","name","mapTypes","set","iconMarker","MarkerImage","icon_url","Point","Marker","position","icon","title","setVisible","addListener","fpv","InfoWindow","content","open","Polyline","path","geodesic","strokeColor","strokeOpacity","strokeWeight","setMap","console","log","location","markPosition","panTo","getPosition","setPosition","setInterval","currData","info","sat_name","country_flag","toFixed","velocity","height","toLocaleString","setContent","push","setPath","clearInterval","setSatellite","sat","setIcon","setTimeDiff","val","width"],"mappings":"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","sourcesContent":["import React,{useState,createRef,useRef,useEffect,forwardRef, useImperativeHandle} from 'react'\r\nimport { getSatelliteInfo } from \"tle.js\";\r\n\r\nvar posInterval,timeDiff,pathInterval,map,marker,mymarker,infoWindow,myinfoWindow,polyLine,poly=[],tle,data\r\n\r\nfunction getNormalizedCoord(coord, zoom) {\r\n        const y = coord.y;\r\n        let x = coord.x;\r\n        const tileRange = 1 << zoom;\r\n        if (y < 0 || y >= tileRange) {\r\n          return null;\r\n        }\r\n        if (x < 0 || x >= tileRange) {\r\n          x = ((x % tileRange) + tileRange) % tileRange;\r\n        }\r\n        return {\r\n          x: x,\r\n          y: y\r\n        };\r\n      }\r\n\r\nconst MapView=forwardRef((props,ref)=>{\r\n  tle=[props.data.tle_line1,props.data.tle_line2]\r\n  data=props.data\r\n  timeDiff=props.timeDiff\r\n  const [satCode,setSatCode]=useState(props.satCode)\r\n  const initialData=getSatelliteInfo(tle,Date.now()+timeDiff,0,0)\r\n  const containerRef=useRef()\r\n\r\n\r\n  useEffect(()=>{\r\n    poly=[]\r\n    map = new window.google.maps.Map(containerRef.current, {\r\n      center: {\r\n        lat: initialData.lat,\r\n        lng: initialData.lng\r\n      },\r\n      zoom: 3,\r\n      streetViewControl: false,\r\n      mapTypeControlOptions: {\r\n        mapTypeIds: [window.google.maps.MapTypeId.ROADMAP,window.google.maps.MapTypeId.HYBRID,'Sky']\r\n      }\r\n    });\r\n\r\n    const skyMapType = new window.google.maps.ImageMapType({\r\n      getTileUrl: function(coord, zoom) {\r\n        const normalizedCoord = getNormalizedCoord(coord, zoom);\r\n\r\n        if (!normalizedCoord) {\r\n          return \"\";\r\n        }\r\n\r\n        const bound = Math.pow(2, zoom);\r\n        return (\r\n          \"https://mw1.google.com/mw-planetary/sky/skytiles_v1\" +\r\n          \"/\" +\r\n          normalizedCoord.x +\r\n          \"_\" +\r\n          (bound - normalizedCoord.y - 1) +\r\n          \"_\" +\r\n          zoom +\r\n          \".jpg\"\r\n        );\r\n      },\r\n      tileSize: new window.google.maps.Size(256, 256),\r\n      maxZoom: 9,\r\n      minZoom: 0,\r\n      radius: 1738000,\r\n      name: \"Sky\"\r\n    });\r\n\r\n    map.mapTypes.set(\"Sky\", skyMapType);\r\n\r\n    let iconMarker = new window.google.maps.MarkerImage(\r\n                      data.icon_url,\r\n                      null,\r\n                      new window.google.maps.Point(0, 0), /* origin is 0,0 */\r\n                      new window.google.maps.Point(30, 30), /* anchor is bottom center of the scaled image */\r\n                      new window.google.maps.Size(60, 50)\r\n                  );\r\n\r\n     marker = new window.google.maps.Marker({\r\n        position: map.center,\r\n        icon:iconMarker,\r\n        title:\"Hello World!\"\r\n    });\r\n\r\n\r\n    mymarker = new window.google.maps.Marker({\r\n       position: map.center\r\n   });\r\n   mymarker.setVisible(false)\r\n\r\n\r\n\r\n\r\n    marker.addListener(\"click\", () => {\r\n          props.fpv()\r\n        });\r\n\r\n    infoWindow = new window.google.maps.InfoWindow({\r\n      content: '<div>Hello World !!!</div>'\r\n    });\r\n\r\n    myinfoWindow = new window.google.maps.InfoWindow({\r\n      content: '<div>Your Location</div>'\r\n    });\r\n\r\n    infoWindow.open(map, marker);\r\n\r\n\r\n    polyLine= new window.google.maps.Polyline({\r\n      path: poly,\r\n      geodesic: true,\r\n      strokeColor: \"#FF0000\",\r\n      strokeOpacity: 1.0,\r\n      strokeWeight: 4\r\n    });\r\n\r\n    polyLine.setMap(map)\r\n\r\n    console.log(props.location)\r\n\r\n    if(props.location!=null)\r\n      markPosition(props.location)\r\n      mymarker.setMap(map);\r\n      marker.setMap(map);\r\n\r\n    map.panTo(marker.getPosition())\r\n  },[])\r\n\r\n  const markPosition=location=>{\r\n    mymarker.setPosition({\r\n      lat:location.lat,\r\n      lng:location.lng\r\n    })\r\n    mymarker.setVisible(true)\r\n    myinfoWindow.open(map, mymarker);\r\n    mymarker.setMap(map);\r\n    marker.setMap(map);\r\n    map.panTo(marker.getPosition())\r\n\r\n  }\r\n\r\n  useEffect(()=>{\r\n    if(satCode) {\r\n      posInterval = setInterval(() => {\r\n        var currData=getSatelliteInfo(tle,Date.now()+timeDiff,0,0)\r\n        marker.setPosition({\r\n          lat:currData.lat,\r\n          lng:currData.lng\r\n        })\r\n\r\n        var info=`<div>\r\n            <center><span>${data.sat_name}</span></center>\r\n            <center><img   height=\"30px\" width='40px' src='${data.country_flag}'/></center>`+\r\n            '<center>Lat:'+currData.lat.toFixed(3)+', Lng:'+currData.lng.toFixed(3)+'</center>'+\r\n            '<center>Velocity:'+currData.velocity.toFixed(3)+'km/s <br/> Height:'+currData.height.toFixed(3)+'km</center>'+\r\n            '<center>'+new Date(Date.now()+timeDiff).toLocaleString()+'</center>'+\r\n            '</div>'\r\n\r\n        infoWindow.setContent(info)\r\n      }, 100);\r\n      pathInterval = setInterval(() => {\r\n        var currData=getSatelliteInfo(tle,Date.now()+timeDiff,0,0)\r\n        poly.push(currData)\r\n        polyLine.setPath(poly)\r\n      }, 1000);\r\n    } else {\r\n      clearInterval(posInterval);\r\n      clearInterval(pathInterval);\r\n    }\r\n  },[satCode])\r\n\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    setSatellite(sat){\r\n      data=sat.data\r\n      tle=[sat.data.tle_line1,sat.data.tle_line2]\r\n      poly=[]\r\n      var currData=getSatelliteInfo(tle,Date.now()+timeDiff,0,0)\r\n      var iconMarker = new window.google.maps.MarkerImage(\r\n                        data.icon_url,\r\n                        null,\r\n                        new window.google.maps.Point(0, 0), /* origin is 0,0 */\r\n                        new window.google.maps.Point(30, 30), /* anchor is bottom center of the scaled image */\r\n                        new window.google.maps.Size(60, 50)\r\n                    );\r\n      marker.setIcon(iconMarker)\r\n      map.panTo({\r\n        lat:currData.lat,\r\n        lng:currData.lng\r\n      })\r\n      setSatCode(sat.satCode)\r\n\r\n    },\r\n    setTimeDiff(val){\r\n      poly=[]\r\n      var currData=getSatelliteInfo(tle,Date.now()+val,0,0)\r\n      var iconMarker = new window.google.maps.MarkerImage(\r\n                        data.icon_url,\r\n                        null,\r\n                        new window.google.maps.Point(0, 0), /* origin is 0,0 */\r\n                        new window.google.maps.Point(30, 30), /* anchor is bottom center of the scaled image */\r\n                        new window.google.maps.Size(60, 50)\r\n                    );\r\n      marker.setIcon(iconMarker)\r\n      map.panTo({\r\n        lat:currData.lat,\r\n        lng:currData.lng\r\n      })\r\n      timeDiff=val\r\n    },\r\n    location(location){\r\n      markPosition(location)\r\n      map.panTo(marker.getPosition())\r\n      //console.log(lat,lng)\r\n    }\r\n }));\r\n\r\n\r\n  return(\r\n    <div  style={{ width: \"100%\", height: \"100%\" }} ref={containerRef}/>\r\n  )\r\n})\r\n\r\nexport default MapView\r\n"]},"metadata":{},"sourceType":"module"}